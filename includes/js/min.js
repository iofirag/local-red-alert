function Alert(e,t){var n=new TimeStamp;var r={alertId:e,areaList:t,time:n};return r}function Area(e,t,n,r){var i={areaNumber:e,areaName:t,timeToShow:n,placeList:r};return i}function Place(e){var t={placeName:e}}function TimeStamp(){var e=new Date;tempHour="0"+e.getHours();tempMinutes="0"+e.getMinutes();tempHour=tempHour.substring(tempHour.length-2);tempMinutes=tempMinutes.substring(tempMinutes.length-2);time=tempHour+":"+tempMinutes;var t={hour:e.getHours(),minutes:e.getMinutes(),timeReceived:time};return t}function readFromJson(){$.getJSON("includes/js/database.json",function(e){for(i in e){database.push(e[i])}})}function jsonLoader(){alertFile="https://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20html%20where%20url%3D%22http%3A%2F%2Fwww.oref.org.il%2FWarningMessages%2Falerts.json%22%20and%20charset%3D'utf-16'&format=json&diagnostics=true&callback=";$.ajax({dataType:"json",url:alertFile,type:"GET",success:function(e){var t=e.query.results.body.p;console.log(t);var r=[];var s=[];var o;var u=[];var a;var f;for(i=0;i<t.length;i++){c=t[i];if(c>="a"&&c<="z"||c>="A"&&c<="Z"||c>="0"&&c<="9"){r.push(t[i])}else{if(r.length>0){str="";for(j=0;j<r.length;j++){str+=r[j]}if(str!="id"&&str!="title"&&str!="data"){s.push(str)}r=[]}}}for(k=0;k<s.length;k++){if(k==0){o=s[k]}else{var l=getAreaObj_ByNum(parseInt(s[k]));u.push(l)}}if(u.length>0&&(alertItem==null||o!=alertItem.alertId&&u.length>0)){alertItem=new Alert(o,u);var h="";for(n=0;n<alertItem.areaList.length;n++){for(j=0;j<alertItem.areaList[n].placeList.length;j++){h+=alertItem.areaList[n].placeList[j];if(n<alertItem.areaList.length-1)h+=", "}}$("h1").prepend("<section>"+alertNoise+alertItem.time.timeReceived+" id="+alertItem.alertId+" {"+h+"}"+"</section>")}u=[]},error:function(e,t){console.log(arguments);alert(" Can't do because: "+t)}})}function getAreaObj_ByNum(e){var t=new Area;t.areaNumber=e;t.areaName=null;t.timeToShow="";placeList=[];for(i in database){if(database[i].ExcelAreaNumber==e){if(t.timeToShow==""){t.timeToShow=database[i].ExcelTimeToShow}placeList.push(database[i].ExcelPlaceName)}}t.placeList=placeList;return t}var alertItem;var database=[];var alertNoise="<object height='0' width='0' data='alarm.mp3'></object>";$(document).ready(function(){readFromJson()});window.setInterval(function(){jsonLoader()},3e3)